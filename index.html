<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Breast Cancer Classification (ONNX Model)</title>
  <link rel="stylesheet" href="styles_11.css" />
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
</head>
<body>
  <div class="container">
    <h1>Breast Cancer Prediction (ONNX)</h1>
    <p>
      This interactive demo runs your trained <strong>PyTorch model</strong> (exported to
      <strong>ONNX</strong>) entirely in the browser using
      <strong>ONNX Runtime Web</strong>. Enter the 30 feature values from the Breast Cancer dataset,
      separated by commas.
    </p>

    <textarea id="features" rows="4" placeholder="Example: 14.5, 20.2, 96.7, ..."></textarea>

    <div class="buttons">
      <button id="predictBtn">Run Prediction</button>
      <button id="clearBtn" class="secondary">Clear</button>
    </div>

    <div id="resultBox" class="hidden">
      <h2>Prediction Result</h2>
      <p id="output"></p>
    </div>

    <footer>
      <p>Deployed using ONNX Runtime Web & GitHub Pages — © 2025 prat459</p>
    </footer>
  </div>

  <script>
    const predictBtn = document.getElementById("predictBtn");
    const clearBtn = document.getElementById("clearBtn");
    const output = document.getElementById("output");
    const resultBox = document.getElementById("resultBox");
    const featuresBox = document.getElementById("features");

    // Prefill example
    featuresBox.value =
      "14.5, 20.2, 96.7, 600.1, 0.09, 0.07, 0.04, 0.02, 0.15, 0.06, 0.25, 1.5, 2.2, 20.1, 0.004, 0.02, 0.03, 0.01, 0.01, 0.003, 16.4, 26.1, 110.4, 820.4, 0.13, 0.25, 0.27, 0.08, 0.25, 0.09";

    clearBtn.addEventListener("click", () => {
      featuresBox.value = "";
      resultBox.classList.add("hidden");
    });

    predictBtn.addEventListener("click", async () => {
      resultBox.classList.remove("hidden");
      output.textContent = "Running inference...";

      const inputText = featuresBox.value.trim();
      if (!inputText) {
        output.textContent = "Please enter input features.";
        return;
      }

      const inputArray = inputText.split(",").map(v => parseFloat(v.trim()));
      if (inputArray.length !== 30) {
        output.textContent = `Expected 30 features, got ${inputArray.length}.`;
        return;
      }
      if (inputArray.some(isNaN)) {
        output.textContent = "Invalid numeric input detected!";
        return;
      }

      try {
        // Load ONNX model
        const session = await ort.InferenceSession.create("models/breast_cancer_deep_mlp.onnx");
        const tensor = new ort.Tensor("float32", Float32Array.from(inputArray), [1, inputArray.length]);

        // Run inference
        const results = await session.run({ input: tensor });
        const prob = results.prob.data[0];
        const pred = prob > 0.5 ? "Malignant (1)" : "Benign (0)";

        output.innerHTML = `
          <strong>Predicted Class:</strong> ${pred}<br>
          <strong>Probability of Malignant:</strong> ${(prob * 100).toFixed(2)}%
        `;
      } catch (err) {
        console.error(err);
        output.textContent = "Error loading or running ONNX model.";
      }
    });
  </script>
</body>
</html>

